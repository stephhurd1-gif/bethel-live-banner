<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bethel Live Banner</title>

  <style>
    :root {
      --header-height-desktop: 56px;
      --header-height-mobile: 64px;
      --live-bg: #E41C23;
      --offline-bg: #111111;
      --text: #ffffff;
    }

    html, body {
      margin: 0;
      padding: 0;
      background: transparent;
      overflow: hidden;
    }

    .banner {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: var(--header-height-desktop);
      padding: 10px 14px;
      box-sizing: border-box;
      display: none;
      z-index: 9999;
      color: var(--text);
      font-family: Arial, sans-serif;
    }

    .bannerInner {
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
    }

    a.bannerLink {
      color: var(--text);
      text-decoration: none;
      display: flex;
      flex-direction: column;
      align-items: center;
      line-height: 1.1;
    }

    .titleRow {
      font-weight: 800;
      font-size: 16px;
      letter-spacing: 0.2px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .subRow {
      margin-top: 2px;
      font-size: 12px;
      font-weight: 600;
      opacity: 0.92;
    }

    .live { background: var(--live-bg); }
    .offline { background: var(--offline-bg); }

    #spacer {
      display: none;
      height: var(--header-height-desktop);
    }

    /* ðŸ”´ Pulsing LIVE dot */
    .liveDot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #ffffff;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%   { box-shadow: 0 0 0 0 rgba(255,255,255,0.7); }
      70%  { box-shadow: 0 0 0 8px rgba(255,255,255,0); }
      100% { box-shadow: 0 0 0 0 rgba(255,255,255,0); }
    }

    @media (max-width: 520px) {
      .banner { height: var(--header-height-mobile); }
      #spacer { height: var(--header-height-mobile); }
    }
  </style>
</head>

<body>

  <div id="banner" class="banner">
    <div class="bannerInner">
      <a id="link" class="bannerLink" href="#" target="_blank" rel="noopener">
        <span id="title" class="titleRow"></span>
        <span id="sub" class="subRow">Join us Sundays at 9:30 AM</span>
      </a>
    </div>
  </div>

  <div id="spacer"></div>

  <script>
    (function () {

      const API_KEY    = "AIzaSyAUjf8QLzCafhgxSI8LN7e116-VZgcw4kg";
      const CHANNEL_ID = "UCvFyu7ybvACGGblAZxuE93g";

      const WATCH_LIVE_PAGE = "https://bethelamelancaster.com/watch-live";
      const REPLAY_PAGE     = "https://bethelamelancaster.com/watch-live#replay";

      const banner = document.getElementById("banner");
      const spacer = document.getElementById("spacer");
      const link   = document.getElementById("link");
      const title  = document.getElementById("title");
      const sub    = document.getElementById("sub");

      function showCommon() {
        banner.style.display = "block";
        spacer.style.display = "block";
      }

      function showLive() {
        banner.className = "banner live";
        title.innerHTML = '<span class="liveDot"></span>Watch Live Now';
        sub.textContent = "Join us Sundays at 9:30 AM";
        link.href = WATCH_LIVE_PAGE;
        showCommon();
      }

      function showOffline() {
        banner.className = "banner offline";
        title.textContent = "â–¶ Watch Last Service";
        sub.textContent = "Join us Sundays at 9:30 AM";
        link.href = REPLAY_PAGE;
        showCommon();
      }

      async function checkLive() {
        try {
          const url =
            "https://www.googleapis.com/youtube/v3/search" +
            "?part=snippet" +
            "&channelId=" + CHANNEL_ID +
            "&eventType=live&type=video&maxResults=1" +
            "&key=" + API_KEY;

          const res = await fetch(url, { cache: "no-store" });
          const data = await res.json();

          if (data.items && data.items.length) {
            showLive();
          } else {
            showOffline();
          }
        } catch {
          showOffline();
        }
      }

      checkLive();
      setInterval(checkLive, 60000);

    })();
  </script>

</body>
</html>
